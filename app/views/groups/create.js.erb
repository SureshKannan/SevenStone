<% begin %>
	<% if @mode=="new"%>
		try
		{
			<% if (@group.new_record? == false) %>	
				window.parent.updateData("new","<%=escape_javascript(render(:partial => "shared/groups"))%>","0","groups");
				$("#group_name").val("");
				$("#group_name").focus();
			<% else %>
				alert('Error creating group!');
			<% end %>
			
		}
  		catch(err)
  		{
  			alert("error" + err.message);
  		}		
	<% else %>
		try
		{
			str = " <tr id='r<%=@group.id%>'> " + 
  			  	 " <td><input type='checkbox' id='c<%=@group.id%>' value='<%=@group.id%>' name='ps[]'/></td> " +
  			  	 " <td><%=@group.name %></td> ";
	  		<% if !@group.created_at.nil?  %>
				str += "<td><%=@group.created_at.strftime('%Y-%m-%d')%></td>";
	  		<% end %>
	  		<% if @group.status.nil? %>
				str += "<td>Active</td>";
	  		<% else %>
	    		str += "<td>Inactive</td>";
	  		<% end %>
	  		str += "<td>";
  			str += "<%=escape_javascript(link_to(image_tag('delete.png',:border=>0), {:action=>'delete',:id=> @group.id,:page=>@page},:method=>:post, :remote=>true, :data=> { :confirm=>'Are you sure?' })) %>";
  			str += "</td>";
 			str += "</tr>";
 			window.parent.updateData("edit",str,"r<%=@group.id%>","groups");
			window.parent.closeWindow("r<%=@group.id%>");
  		}
  		catch(err)
  		{
  			alert("error" + err.message);
  		}
	<% end %>
<% rescue Exception => e %>
	alert("<%=e.message%>");
	<% puts "error in rescue"%>
	<% puts e.message %>
<% end %>

